<?xml version="1.0"?>
<rdf:RDF
  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:dcterms="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:wiki="http://purl.org/rss/1.0/modules/wiki/"
  xmlns:chefmoz="http://chefmoz.org/rdf/elements/1.0/"
  xmlns:wn="http://xmlns.com/wordnet/1.6/"
  xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
  xmlns:os="http://downlode.org/Code/RDF/Ordnance_Survey/schema/1#"
  xmlns:owl="http://www.w3.org/2002/07/owl#"
  xmlns:map="http://www.daml.org/2001/06/map/map-ont#"
  xmlns="http://www.w3.org/2000/10/swap/pim/contact#"
>

  <rdf:Description rdf:about="">
    <dc:title>[% site_name %]: [% node_name %]</dc:title>
    <dc:date>[% timestamp %]</dc:date>
    <dcterms:modified>[% timestamp %]</dcterms:modified>

    [% FOREACH contributor = contributors.values %] 
    <dc:contributor>
      <foaf:Person rdf:ID="[% contributor.user_id %]">
        <foaf:nick>[% contributor.username %]</foaf:nick>
      </foaf:Person>
    </dc:contributor>
    [% END %]

    <dc:source rdf:resource="[% node_uri %]" />
    <wiki:version>[% version %]</wiki:version>
    <foaf:topic rdf:resource="#obj" />
  </rdf:Description>

  <[% obj_type %] rdf:ID="obj" dc:title="[% node_name %]">

    [% IF summary %]
      <dc:description>[% summary %]</dc:description>
    [% END %]

    [% IF categories %]
      <!-- categories -->

      [% FOREACH category = categories %]
        <dc:subject>[% category.name %]</dc:subject>
      [% END %]
    [% END %]

    [% IF is_geospatial %]
      <!-- address and geospatial data -->

      [% IF address %]
        <address>[% address %]</address>
      [% END %]
      [% IF city %]
        <city>[% city %]</city>
      [% END %]
      [% IF postcode %]
        <postalCode>[% postcode %]</postalCode>
      [% END %]
      [% IF country %]
        <country>[% country %]</country>
      [% END %]

      [% IF map_link %]
        <foaf:page>
          <map:Map rdf:about="[% map_link %]" />
        </foaf:page>
      [% END %]

      [% FOREACH locale = locales %]
        <foaf:based_near>
          <wn:Neighborhood rdf:ID="[% locale.id %]">
            <dc:title>[% locale.name %]</dc:title>
          </wn:Neighborhood>
        </foaf:based_near>
      [% END %]

      [% IF wgs84_lat AND wgs84_long %]
        <geo:lat>[% wgs84_lat %]</geo:lat>
        <geo:long>[% wgs84_long %]</geo:long>
      [% END %]

      [% IF os_x AND os_y %]
        <os:x>[% os_x %]</os:x>
        <os:y>[% os_y %]</os:y>
      [% END %]

    [% END %]

    [% IF phone OR fax OR website OR opening_hours_text %]
      <!-- contact information -->
      [% IF phone %]
        <phone>[% phone %]</phone>
      [% END %]
      [% IF fax %]
        <fax>[% fax %]</fax>
      [% END %]
      [% IF website %]
        <foaf:homepage rdf:resource="[% website %]" />
      [% END %]
      [% IF opening_hours_text %]
        <chefmoz:Hours>[% opening_hours_text %]</chefmoz:Hours>
      [% END %]
    [% END %]

    [% IF redirect %]
      <owl:sameAs rdf:resource="[% redirect %]" />
    [% END %]

  </[% obj_type %]>
</rdf:RDF>
